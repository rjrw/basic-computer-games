  10 PRINT TAB(30);"TIC-TAC-TOE"
  20 PRINT TAB(15);"CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
  30 PRINT:PRINT:PRINT
  40 PRINT "THE BOARD IS NUMBERED:"
  50 PRINT " 1  2  3"
  60 PRINT " 4  5  6"
  70 PRINT " 7  8  9"
  80 PRINT:PRINT:PRINT
  90 DIM S(9)
 100 INPUT"DO YOU WANT 'X' OR 'O'";C$
 110 IF C$="X"THEN 720
 120 P$="O":Q$="X"
 130 G=-1:H=1:IF S(5)<>0 THEN 150
 140 S(5)=-1:GOTO 690
 150 IF S(5)<>1 THEN 180
 160 IF S(1)<>0 THEN 220
 170 S(1)=-1:GOTO 690
 180 IF S(2)=1 AND S(1)=0 THEN 640
 190 IF S(4)=1 AND S(1)=0 THEN 640
 200 IF S(6)=1 AND S(9)=0 THEN 680
 210 IF S(8)=1 AND S(9)=0 THEN 680
 220 IF G<>1 THEN 280
 230 J=3*INT((M-1)/3)+1
 240 IF 3*INT((M-1)/3)+1=M THEN K=1
 250 IF 3*INT((M-1)/3)+2=M THEN K=2
 260 IF 3*INT((M-1)/3)+3=M THEN K=3
 270 GOTO 285
 280 FOR J=1 TO 7 STEP 3:FOR K=1 TO 3
 285 X=0
 290 IF S(J)<>G THEN 330
 300 IF S(J+2)<>G THEN 370
 310 IF S(J+1)<>0 THEN 400
 320 S(J+1)=-1:X=1:GOTO 510
 330 IF S(J)=H THEN 400
 340 IF S(J+2)<>G THEN 400
 350 IF S(J+1)<>G THEN 400
 360 S(J)=-1:X=1:GOTO 510
 370 IF S(J+2)<>0 THEN 400
 380 IF S(J+1)<>G THEN 400
 390 S(J+2)=-1:X=1:GOTO 510
 400 IF S(K)<>G THEN 440
 410 IF S(K+6)<>G THEN 480
 420 IF S(K+3)<>0 THEN 510
 430 S(K+3)=-1:X=1:GOTO 510
 440 IF S(K)=H THEN 510
 450 IF S(K+6)<>G THEN 510
 460 IF S(K+3)<>G THEN 510
 470 S(K)=-1:X=1:GOTO 510
 480 IF S(K+6)<>0 THEN 510
 490 IF S(K+3)<>G THEN 510
 500 S(K+6)=-1:X=1:GOTO 510
 510 IF X=1 THEN 690
 515 IF G=1 THEN 530
 520 NEXT K,J
 530 IF S(5)=G THEN 550
 540 GOTO 590
 550 IF S(3)=G AND S(7)=0 THEN 670
 560 IF S(9)=G AND S(1)=0 THEN 640
 570 IF S(7)=G AND S(3)=0 THEN 660
 580 IF S(9)=0 AND S(1)=G THEN 680
 590 IF G=-1 THEN G=1:H=-1:GOTO 220
 600 IF S(9)=1 AND S(3)=0 THEN 650
 610 FOR I=2 TO 9:IF S(I)<>0 THEN 630
 620 S(I)=-1:GOTO 690
 630 NEXT I
 640 S(1)=-1:GOTO 690
 650 IF S(1)=1 THEN 610
 660 S(3)=-1:GOTO 690
 670 S(7)=-1:GOTO 690
 680 S(9)=-1
 690 PRINT:PRINT"THE COMPUTER MOVES TO..."
 700 GOSUB 810
 710 GOTO 730
 720 P$="X":Q$="O"
 730 PRINT:INPUT"WHERE DO YOU MOVE";M
 740 IF M=0 THEN PRINT"THANKS FOR THE GAME.":GOTO 1110
 750 IF M>9 THEN 770
 760 IF S(M)=0 THEN 780
 770 PRINT"THAT SQUARE IS OCCUPIED.":PRINT:PRINT:GOTO 730
 780 G=1:S(M)=1
 790 GOSUB 810
 800 GOTO 130
 810 PRINT:FOR I=1 TO 9:PRINT" ";:IF S(I)<>-1 THEN 830
 820 PRINT Q$" ";:GOTO 860
 830 IF S(I)<>0 THEN 850
 840 PRINT"  ";:GOTO 860
 850 PRINT P$" ";
 860 IF I<>3 AND I<>6 THEN 890
 870 PRINT:PRINT"---+---+---"
 880 GOTO 910
 890 IF I=9 THEN 910
 900 PRINT"!";
 910 NEXT I:PRINT:PRINT:PRINT
 920 FOR I=1 TO 7 STEP 3
 930 IF S(I)<>S(I+1)THEN 970
 940 IF S(I)<>S(I+2)THEN 970
 950 IF S(I)=-1 THEN 1090
 960 IF S(I)=1 THEN 1080
 970 NEXT I:FOR I=1 TO 3:IF S(I)<>S(I+3)THEN 1010
 980 IF S(I)<>S(I+6)THEN 1010
 990 IF S(I)=-1 THEN 1090
1000 IF S(I)=1 THEN 1080
1010 NEXT I:FOR I=1 TO 9:IF S(I)=0 THEN 1030
1020 NEXT I:GOTO 1100
1030 IF S(5)<>G THEN 1060
1040 IF S(1)=G AND S(9)=G THEN 1070
1050 IF S(3)=G AND S(7)=G THEN 1070
1060 RETURN
1070 IF G=-1 THEN 1090
1080 PRINT"YOU BEAT ME!! GOOD GAME.":GOTO 1110
1090 PRINT"I WIN, TURKEY!!!":GOTO 1110
1100 PRINT"IT'S A DRAW. THANK YOU."
1110 END
